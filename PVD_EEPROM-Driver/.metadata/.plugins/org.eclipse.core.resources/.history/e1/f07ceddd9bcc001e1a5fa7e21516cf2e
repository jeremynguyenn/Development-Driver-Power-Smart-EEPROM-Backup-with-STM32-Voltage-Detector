#include "pvd.h"

#define PWR_EN		(1U<<28)

void pvd_init(void)
{
	/*Enable clock access to PWR module*/
	RCC->APB1ENR |=PWR_EN;
	/*Set PVD threshold value*/
	PWR->CR &=~PWR_CR_PLS;
	PWR->CR  |=PWR_CR_PLS_LEV7;

	/*Enable PWR PVD EXTI */
	EXTI->IMR |=(EXTI_IMR_MR16);

	/*Enable Falling edge detection*/
	EXTI->FTSR |=EXTI_IMR_MR16;

	/*Enable PVD*/
	PWR->CR |=(1U<<4);

	/*Enable PVD Interrupt in NVIC*/
	NVIC_EnableIRQ(PVD_IRQn);
}
